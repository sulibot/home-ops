---
# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/helm.toolkit.fluxcd.io/helmrelease_v2.json
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: cloudflared
spec:
  interval: 1h
  chart:
    spec:
      chart: cloudflare-tunnel
      reconcileStrategy: ChartVersion
      sourceRef:
        kind: HelmRepository
        name: cloudflare
        namespace: flux-system
      version: 0.3.2
  values:
    image:
      repository: cloudflare/cloudflared
      tag: "2025.10.0"
      pullPolicy: IfNotPresent
    env:
      - name: TUNNEL_EDGE_IP_VERSION
        value: "6"
      - name: TUNNEL_TRANSPORT_PROTOCOL
        value: "quic"
    cloudflare:
      account: 089ac5ef7a1525cb7d7129cdde5873cd
      enableWarp: false
      ingress:
        - hostname: plex.sulibot.com
          service: http://plex.default.svc.cluster.local:32400
        - hostname: overseerr.sulibot.com
          service: http://overseerr.default.svc.cluster.local:80
        - hostname: hello.sulibot.com
          service: hello_world
      secret: ENC[AES256_GCM,data:DnxDgpnpwOKTmK1cSx+duNyaxFYncFMqfNgdOHOZ2PaGvUtW1Ap//32Z/7c=,iv:lBAxf7PmgfER1tZK7+8B0OzkqhblZVWKMuKmmDd5zIE=,tag:+8a9lTWVZ43Q+4SQ3vIvZQ==,type:str]
      secretName: null
      tunnelId: 0977043f-80e9-4549-a6f0-0af145a17f27
      tunnelName: sulibot-tunnel
    fullnameOverride: ""
    imagePullSecrets: []
    nameOverride: ""
    nodeSelector: {}
    podAnnotations: {}
    podLabels: {}
    podSecurityContext:
      runAsNonRoot: true
      runAsUser: 65532
      runAsGroup: 65532
      fsGroup: 65532
      fsGroupChangePolicy: OnRootMismatch
    replicaCount: 2
    resources:
      requests:
        cpu: 10m
        memory: 64Mi
      limits:
        memory: 256Mi
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      readOnlyRootFilesystem: true
    serviceAccount:
      annotations: {}
      name: ""
    tolerations: []
    affinity: {}
    dnsConfig:
      options:
        - name: ndots
          value: "1"
        - name: single-request
        - name: single-request-reopen
sops:
  kms: []
  gcp_kms: []
  azure_kv: []
  hc_vault: []
  age:
    - recipient: age1k3sunyva3kc3jusxs3j93nyueqjgzcgg6s6qghn8aeqpuy7l35wss8gxvg
      enc: |
        -----BEGIN AGE ENCRYPTED FILE-----
        YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBMTXlNbUV2SDFnRUkvOU5B
        b05LSHlnamYvdlN1YWx3YVA1dE0yZVZnZVNNCjE3NVZQcnFqODhRTWlPSyt5NDlK
        T1hCU296Y2JHS0Q3TnROTUlNZm1hK2MKLS0tIDBQYVRIdTd1anhKbkEyS0c3cTlo
        OHdJd00yK0VMcGpIRXc3ZlBpQVNmNjQKFUWjWCenBu53y90V9CJfxz4mUIW5Njh5
        6MLEEraplQq+EWtKi1H7o43ZO8LdF1Ukma37fM6oZVnRfuD4NoL5cg==
        -----END AGE ENCRYPTED FILE-----
  lastmodified: "2024-12-15T09:13:39Z"
  mac: ENC[AES256_GCM,data:9w1ouvwEZfMNlUjGu7/DxwZUCwg5M7uaJZyBg2buyIc5HwDIasTpVL6NeiwfJ717zvtXFqiYQr0aAW5aA8j2Au22Y7X3Y61CFqUcd1qVtQwL2SWuCdS6EIYxILexGs7eqE69gSYRO9eedr79dR4IurAaJRBzP5OTRPIu82nZDPc=,iv:EBRc69Jt4rOWkGr4xfv9l9XJ3jbCCp8Nt/d2p8vOjlM=,tag:PkA2SlZXv5U+T5vtwOSDvw==,type:str]
  pgp: []
  encrypted_regex: ^(adminKey|userKey|secret)$
  version: 3.9.1
