# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/helm.toolkit.fluxcd.io/helmrelease_v2.json
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
    name: ceph-csi
spec:
    chart:
        spec:
            chart: ceph-csi-cephfs
            version: 3.15.0
            sourceRef:
                kind: HelmRepository
                name: ceph-csi
                namespace: flux-system
    interval: 1h
    values:
        csiConfig:
            - cephFS:
                subvolumeGroup: csi
              clusterID: e919300b-6e62-4c63-90ca-199d5307f9bf
              monitors:
                - '[fc00:20::1]:3300'
                - '[fc00:20::2]:3300'
                - '[fc00:20::3]:3300'
        logLevel: 5
        secret:
            adminID: admin
            adminKey: ENC[AES256_GCM,data:d9BIl+DuPyzvT0Zt98AVx0unLuSXZCLuYauIliHnMr6O8I5KjelADw==,iv:QSGQqRw1PBZzsrmc6mCGryVSgAp0JmShsphht3aW9oo=,tag:8P1++zizHfg2iXMO7nGZHA==,type:str]
            create: true
            name: csi-cephfs-secret
        storageClass:
            allowVolumeExpansion: true
            clusterID: e919300b-6e62-4c63-90ca-199d5307f9bf
            controllerExpandSecret: csi-cephfs-secret
            controllerExpandSecretNamespace: ceph-csi-cephfs
            create: true
            fsName: kubernetes
            pool: kubernetes_data
            name: csi-cephfs-sc
            nodeStageSecret: csi-cephfs-secret
            nodeStageSecretNamespace: ceph-csi-cephfs
            provisionerSecret: csi-cephfs-secret
            provisionerSecretNamespace: ceph-csi-cephfs
            reclaimPolicy: Delete
            volumeNamePrefix: sol-csi-vol
sops:
    age:
        - recipient: age1k3sunyva3kc3jusxs3j93nyueqjgzcgg6s6qghn8aeqpuy7l35wss8gxvg
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBrZ0pVVWFVMGtHSmxjdHBV
            T0E5aVhsWkYrSTE2aTZKZEtpM1lsM1J3VG1rCnVlZ1ZJSzJQcmNBaEFPQzdlaklj
            eGYreGlEUUR5Yjcrd2k3NHltOHVkMGsKLS0tIG11d2tJUkNDNzdJcmQ3bFBqV3ZN
            YWxKai81QURCd0dNMzRxTGpDOTlSejAKKRwd/2bD6R2yfbnvjMSJTosDIGVRCbJ5
            3UlInSgareDf5OpPBgbJVtql8yM5ROTv87trWCuKj/WvK+3UkadrPA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-10-25T07:32:30Z"
    mac: ENC[AES256_GCM,data:2lHJO1hubJc1kMrp8I58Y0EiWGyZArwVtdFcdZmnei0yIvjj2LQYCUJ9+hVJ4Z+PjumpizRdkK/pCgyX/aYEgX8wZh9XFNg+2tY5fXdTE7P6MBNalS1jYpUf3FFdUGqWWk4mY6ly9Vp1KQdR5yW+I5F21ECF9PJtU7MY3002CUs=,iv:Z+VUzp0taP02kSJ4xdU9NGJwNSCEQJUDaLjn7s/dy6o=,tag:C3zXuCb/sXlTr9oEfLjcaQ==,type:str]
    encrypted_regex: ^(adminKey|userKey|api_key|MIKROTIK_PASSWORD|credentials\.json)$
    version: 3.10.2
