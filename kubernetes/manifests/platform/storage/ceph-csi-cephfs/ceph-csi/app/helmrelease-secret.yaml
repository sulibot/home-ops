# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/helm.toolkit.fluxcd.io/helmrelease_v2.json
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
    name: ceph-csi
spec:
    chart:
        spec:
            chart: ceph-csi-cephfs
            version: 3.15.0
            sourceRef:
                kind: HelmRepository
                name: ceph-csi
                namespace: flux-system
    interval: 1h
    values:
        csiConfig:
            - cephFS:
                subvolumeGroup: csi
              clusterID: 407036f5-1f73-44ff-ba81-1f219b7a8a64
              monitors:
                - '[fc00:20::1]:6789'
                - '[fc00:20::2]:6789'
                - '[fc00:20::3]:6789'
        logLevel: 5
        secret:
            userID: admin
            userKey: ENC[AES256_GCM,data:1mdRo1R//BQpj5QmxtxnUoqblHOYzhGXXffg31qVg+05plwjPYdwuA==,iv:mPRJWipSZj8PlMkSqbl76xTJkgROugILjcQ1gbzbS/w=,tag:PHO1MYiQX/dU6ht8IutbTQ==,type:str]
            create: true
            name: csi-cephfs-secret
        storageClass:
            allowVolumeExpansion: true
            clusterID: 407036f5-1f73-44ff-ba81-1f219b7a8a64
            controllerExpandSecret: csi-cephfs-secret
            controllerExpandSecretNamespace: ceph-csi-cephfs
            create: true
            fsName: kubernetes
            pool: kubernetes_data
            name: csi-cephfs-sc
            nodeStageSecret: csi-cephfs-secret
            nodeStageSecretNamespace: ceph-csi-cephfs
            provisionerSecret: csi-cephfs-secret
            provisionerSecretNamespace: ceph-csi-cephfs
            reclaimPolicy: Delete
            volumeNamePrefix: sol-csi-vol
sops:
    age:
        - recipient: age1k3sunyva3kc3jusxs3j93nyueqjgzcgg6s6qghn8aeqpuy7l35wss8gxvg
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBCSUhjRzNBelpNaTVHL0NC
            SXpsaE9pUUhnbStrWTdDeU9JK2U4QVBHaVRrCkNZcmVyTHZ3SWhmOUVjTjl1cVIr
            UXBrdHFaT3RDeUNrNE9meEUzQ0tPSTAKLS0tIEUwWWdNQU5WL2t0SDZkRWtUWWNU
            Z3QwM1dmR1RHTjJPYXdqNHpIQVBMTHMKajIPToo/v+SNbYzvTAfg17vtx68qKSXD
            YcbNvfWfOLfcjCGRZ2AykNcuoXSjLcYsr4dplahCLtKVWZwxV2n5jg==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-10-25T08:30:29Z"
    mac: ENC[AES256_GCM,data:pZtF+Xx7Kbl8G1sYz+RXVZInsYOgxeCcjeCorkIX+nl7ijMx2CCHa+Qw50whQS9cJiN7lRxdqVTKwci6MQHpAYLRWBfqwE/TL69qxIL4p/29KHYVp+XNbkVp49VSo57GKYIM6WtRhJ8buCs+ajO9bhlmyQg7J36jAbeNHbxbXfg=,iv:MHaBspyz0Avt1rrkvSjo4a1eUhaYMczfyFhkNO26O74=,tag:gXdlZJ3yxsRCQPKbHrF/1g==,type:str]
    encrypted_regex: ^(adminKey|userKey|api_key|MIKROTIK_PASSWORD|credentials\.json)$
    version: 3.10.2
