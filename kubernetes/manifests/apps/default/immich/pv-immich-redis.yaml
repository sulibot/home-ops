---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: immich-redis
spec:
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteOnce
  csi:
    driver: cephfs.csi.ceph.com
    nodeStageSecretRef:
      name: csi-cephfs-secret
      namespace: ceph-csi-cephfs
    volumeAttributes:
      clusterID: e919300b-6e62-4c63-90ca-199d5307f9bf
      # Use the main Kubernetes filesystem and let the driver create a subvolume.
      fsName: kubernetes
      # The volumeHandle is the name of the subvolume within the fsName.
    volumeHandle: immich-redis
    # The 'static' volume attribute tells the driver this is a pre-defined volume.
    static: "true"
  persistentVolumeReclaimPolicy: Retain
  # Use a distinct storageClassName for static volumes to avoid provisioner conflicts.
  storageClassName: csi-cephfs-sc-retain
