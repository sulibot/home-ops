loki:
  enabled: true
  isDefault: true

  # Storage backend configuration (S3-compatible Ceph RGW)
  storage:
    type: s3
    s3:
      endpoint: http://minio.sulibot.com # Update with your Ceph RGW URL
      bucketnames: loki-logs
      region: us-east-1
      access_key_id: <your-access-key>
      secret_access_key: <your-secret-key>
      s3ForcePathStyle: true
      insecure: false # Set to true if using an insecure RGW endpoint

  # Retention configuration
  schemaConfig:
    configs:
      - from: 2024-01-01
        store: tsdb
        object_store: s3
        schema: v13
        index:
          prefix: loki_index_
          period: 24h

  # Configuring logs compaction & ruler
  compactor:
    retention_enabled: true
    retention_delete_delay: 24h
    retention_delete_worker_count: 150

  ruler:
    storage:
      type: s3
    rule_path: /loki/rules
    alertmanager_url: http://alertmanager.observability.svc.cluster.local:9093 
    enable_alertmanager_v2: true

# Configuring Loki as a StatefulSet with a Persistent Volume (Optional)
persistence:
  enabled: true
  storageClass: cephfs  # Use CephFS for Loki logs if preferred
  accessModes:
    - ReadWriteOnce
  size: 50Gi

# Exposing Loki via LoadBalancer (or use Ingress if needed)
service:
  type: LoadBalancer
  ports:
    http:
      port: 3100

# Helm deployment settings
deployment:
  replicas: 3  # Adjust based on cluster size

# Logging level
logLevel: info

# Limits and requests for Loki pods
resources:
  limits:
    memory: 4Gi
    cpu: 2
  requests:
    memory: 2Gi
    cpu: 500m
