# General application settings
name: plex                  # Default application name
namespace: media                # Namespace for the application

# Docker container settings
image:
  repository: plexinc/pms-docker
  tag: latest
  digest: ""                    # Optional: Specify a digest for the image (e.g., sha256:...)                 # Image tag for the container
  pullPolicy: IfNotPresent      # Image pull policy

# Timezone
timezone: "America/Los_Angeles"  # Default timezone for the application

# Replica settings
replicaCount: 1

# Gateway configuration
gateway:
  enabled: true                # Enable or disable HTTPRoute
  name: gateway-internal        # Name of the Gateway
  namespace: network            # Namespace of the Gateway
  domain: sulibot.com           # Default domain for hostnames

# Environment variables
env:
# Environment variables
  - name: PLEX_UID
    value: "1000"
  - name: PLEX_GID
    value: "1000"
  # This claim is optional, and is only used for the first startup of PMS
  # The claim is obtained from https://www.plex.tv/claim/ is is only valid for a few minutes
  - name: PLEX_CLAIM
    value: "claim-4SoxeYwNcfSd5PYR45xk"
  - name: HOSTNAME
    value: "plex"
  - name: PLEX_UPDATE_CHANNEL
    value: "plexpass"
  - name: ALLOWED_NETWORKS
    value: "10.0.0.0/8"
  - name: ADVERTISE_IP
    value: "https://plex.sulibot.com:443, http://plex-service.media.svc.cluster.local:80"
  #- name: 
  #  value: 

# Labels and Annotations
labels:
  global: {}                    # Global labels applied to all resources
annotations:
  pod: {}                       # Pod-level annotations

# Port configuration
ports:
  servicePort: 80               # Port exposed by the service
  targetPort: 32400              # Target port in the container

# DNS configuration
dnsPolicy: ClusterFirst          # Default DNS policy
dnsConfig:
  enabled: true
  options:
    - name: ndots
      value: "1"


# Config PVC settings
config:
  enabled: true                # Enable or disable Config PVC
  mountPath: /config            # Mount path for the Config PVC
  storageSize: 10Gi            # Default size for the Config PVC

# Data PVC settings
data:
  enabled: true                 # Enable or disable Data PVC
  mountPath: /data              # Mount path for the Data PVC
  storageSize: 10Gi             # Size of the Data PVC

# Global networking options
networking:
  ipFamilyPolicy: PreferDualStack  # Can be PreferDualStack, RequireDualStack, or SingleStack
  singleStackIPFamily: IPv4        # Default to IPv4 for single-stack clusters

# Pod-level security context
podSecurityContext:
  enabled: true
  runAsUser: 0
  runAsGroup: 0
  fsGroup: 1000
  fsGroupChangePolicy: OnRootMismatch

# Container-level security context
containerSecurityContext:
  enabled: true
  readOnlyRootFilesystem: false
  allowPrivilegeEscalation: true

resources:
  enabled: true      # Set to false if you want to omit resource requests/limits.
  requests:
    cpu: "250m"
    memory: "256Mi"
  limits:
    cpu: "3000m"
    memory: "6Gi"
    gpu.intel.com/i915: 1



# Tolerations and affinity
tolerations: []                 # Define tolerations for node taints
affinity:
  enabled: true                 # Set to true to enable affinity rules; false to disable them entirely.
  nodeAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 1
        preference:
          matchExpressions:
            - key: intel.feature.node.kubernetes.io/gpu
              operator: In
              values:
                - "true"
      - weight: 1
        preference:
          matchExpressions:
            - key: topology.kubernetes.io/host
              operator: In
              values:
                - pve01
                - pve02
                - pve03








# Headless service configuration
headless:
  enabled: true                # Enable or disable headless service

# Ingress configuration
ingress:
  enabled: false                # Enable or disable Ingress
  className: cilium             # Ingress class name
  tls:
    certManagerIssuer: letsencrypt-prod # Cert-manager issuer for TLS certificates



