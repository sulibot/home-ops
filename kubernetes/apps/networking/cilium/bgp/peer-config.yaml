---
# BGP Peer Configuration for BIRD2 on localhost (IPv4)
# Cilium peers with local BIRD2 instance instead of directly with RouterOS
apiVersion: cilium.io/v2
kind: CiliumBGPPeerConfig
metadata:
  name: bird2-peer-ipv4
  namespace: kube-system
spec:
  # Advertise IPv4 pod CIDRs and LoadBalancer IPs
  families:
    - afi: ipv4
      safi: unicast
      advertisements:
        matchExpressions:
          - key: advertise
            operator: In
            values:
              - pod-cidr
              - loadbalancer

  # eBGP multihop (required for localhost peering)
  ebgpMultihop: 2

  # Transport configuration
  transport:
    peerPort: 179

  # Timers
  timers:
    holdTimeSeconds: 90
    keepAliveTimeSeconds: 30

  # Graceful restart
  gracefulRestart:
    enabled: true
    restartTimeSeconds: 120
---
# BGP Peer Configuration for BIRD2 on localhost (IPv6)
# Cilium peers with local BIRD2 instance instead of directly with RouterOS
apiVersion: cilium.io/v2
kind: CiliumBGPPeerConfig
metadata:
  name: bird2-peer-ipv6
  namespace: kube-system
spec:
  # Advertise IPv6 pod CIDRs and LoadBalancer IPs
  families:
    - afi: ipv6
      safi: unicast
      advertisements:
        matchExpressions:
          - key: advertise
            operator: In
            values:
              - pod-cidr
              - loadbalancer

  # eBGP multihop (required for localhost peering)
  ebgpMultihop: 2

  # Transport configuration
  transport:
    peerPort: 179

  # Timers
  timers:
    holdTimeSeconds: 90
    keepAliveTimeSeconds: 30

  # Graceful restart
  gracefulRestart:
    enabled: true
    restartTimeSeconds: 120
