---
# BGP Peer Configuration for upstream router (IPv4 only)
apiVersion: cilium.io/v2
kind: CiliumBGPPeerConfig
metadata:
  name: upstream-router-peer
  namespace: kube-system
spec:
  # Advertise IPv4 pod CIDRs and LoadBalancer IPs
  families:
    - afi: ipv4
      safi: unicast
      advertisements:
        matchExpressions:
          - key: advertise
            operator: In
            values:
              - pod-cidr
              - loadbalancer

  # eBGP multihop (different AS)
  ebgpMultihop: 1

  # Transport configuration
  transport:
    peerPort: 179

  # Timers
  timers:
    holdTimeSeconds: 90
    keepAliveTimeSeconds: 30

  # Graceful restart
  gracefulRestart:
    enabled: true
    restartTimeSeconds: 120
---
# BGP Peer Configuration for upstream router (IPv6 only)
apiVersion: cilium.io/v2
kind: CiliumBGPPeerConfig
metadata:
  name: upstream-router-peer-ipv6
  namespace: kube-system
spec:
  # Advertise IPv6 pod CIDRs and LoadBalancer IPs
  families:
    - afi: ipv6
      safi: unicast
      advertisements:
        matchExpressions:
          - key: advertise
            operator: In
            values:
              - pod-cidr
              - loadbalancer

  # eBGP multihop (different AS)
  ebgpMultihop: 1

  # Transport configuration
  transport:
    peerPort: 179

  # Timers
  timers:
    holdTimeSeconds: 90
    keepAliveTimeSeconds: 30

  # Graceful restart
  gracefulRestart:
    enabled: true
    restartTimeSeconds: 120
