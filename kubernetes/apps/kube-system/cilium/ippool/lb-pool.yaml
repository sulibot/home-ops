---
# LoadBalancer IP Pools for cluster-101
# IPs from these pools will be assigned to LoadBalancer services
# and advertised via BGP to the upstream router
#
# IP Allocation Strategy for cluster-101:
#   Node subnet:     10.0.101.0/24   (fd00:101::/64)
#   Nodes:           10.0.101.1-63   (fd00:101::1-3f)
#   LoadBalancers:   10.0.101.64-127 (fd00:101:40::/120)
#   Reserved/Future: 10.0.101.128-254

---
# IPv4 pool for general LoadBalancer services
apiVersion: cilium.io/v2alpha1
kind: CiliumLoadBalancerIPPool
metadata:
  name: cluster-101-pool-ipv4
  namespace: kube-system
spec:
  blocks:
    - cidr: 10.0.101.64/26  # 10.0.101.64-127 (64 IPs)

  # Optional: Reserve specific IPs for known services
  # Uncomment to prevent auto-assignment to these IPs
  # disabled:
  #   - cidr: 10.0.101.80/32   # Reserved for ingress
  #   - cidr: 10.0.101.81/32   # Reserved for gateway

  # Optional: Only allow services with specific label to use this pool
  # serviceSelector:
  #   matchLabels:
  #     lb-pool: default

---
# IPv6 pool for general LoadBalancer services
# Using separate /120 subnet to avoid conflicts with node IPs
apiVersion: cilium.io/v2alpha1
kind: CiliumLoadBalancerIPPool
metadata:
  name: cluster-101-pool-ipv6
  namespace: kube-system
spec:
  blocks:
    # Use fd00:101:40::/120 to avoid node IPs (fd00:101::1-3f)
    - cidr: fd00:101:40::/120  # fd00:101:40::0-ff (256 IPs)
    # Gateway API subnet (your existing gateway IPs)
    - cidr: fd00:101:1b::/120  # fd00:101:1b::0-ff (256 IPs)

---
# Optional: Dedicated pool for ingress controllers
# Uncomment if you want separate pool for ingress with specific IPs
# apiVersion: cilium.io/v2alpha1
# kind: CiliumLoadBalancerIPPool
# metadata:
#   name: cluster-101-ingress-pool-ipv4
#   namespace: kube-system
# spec:
#   blocks:
#     - cidr: 10.0.101.80/29  # 10.0.101.80-87 (8 IPs)
#   serviceSelector:
#     matchLabels:
#       lb-pool: ingress

---
# Optional: Dedicated pool for gateway API
# apiVersion: cilium.io/v2alpha1
# kind: CiliumLoadBalancerIPPool
# metadata:
#   name: cluster-101-gateway-pool-ipv4
#   namespace: kube-system
# spec:
#   blocks:
#     - cidr: 10.0.101.88/29  # 10.0.101.88-95 (8 IPs)
#   serviceSelector:
#     matchLabels:
#       lb-pool: gateway
