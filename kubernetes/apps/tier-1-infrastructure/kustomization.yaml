---
# yaml-language-server: $schema=https://json.schemastore.org/kustomization
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  # Core infrastructure
  - ./cert-manager/ks.yaml
  - ./cert-manager/issuers/ks.yaml
  - ./metrics-server/ks.yaml
  - ./reloader/ks.yaml
  - ./descheduler/ks.yaml
  - ./coredns/ks.yaml

  # Networking
  - ./multus/ks.yaml
  # istio disabled - commented out
  # - ./istio/helm-repo/ks.yaml
  # - ./istio/ks.yaml
  # - ./istio/namespace-config/ks.yaml
  # - ./istio/waypoints/ks.yaml
  # - ./istio/policies/ks.yaml
  - ../tier-0-foundation/cilium/gateway/ks.yaml
  - ./external-dns/helm-repo/ks.yaml
  - ./external-dns/ks.yaml
  - ./cloudflared/ks.yaml
  - ./certificates/ks.yaml

  # Drivers
  - ./intel-gpu-resource-driver/ks.yaml
  - ./spegel/ks.yaml

  # Data services
  - ./volsync/ks.yaml
  - ./cloudnative-pg/helm-repo/ks.yaml
  - ./cloudnative-pg/ks.yaml
  - ./postgres-vectorchord/ks.yaml
  # redis disabled
  # - ./redis/ks.yaml

  # Observability
  - ./kube-prometheus-stack/ks.yaml
  - ./kube-prometheus-stack/rules/ks.yaml
  - ./kube-prometheus-stack/volsync/ks.yaml
  - ../tier-0-foundation/external-secrets/external-secrets/dashboard/ks.yaml   # Tier 1: depends on grafana-instance
  - ./victoria-logs/ks.yaml
  - ./fluent-bit/ks.yaml
  - ./grafana/ks.yaml
  - ./jaeger/helm-repo/ks.yaml
  - ./jaeger/ks.yaml
  - ./kiali/helm-repo/ks.yaml
  - ./kiali/ks.yaml
  - ./keda/ks.yaml

  # Additional observability
  - ./snmp-exporter/ks.yaml
  - ./silence-operator/ks.yaml
  - ./blackbox-exporter/ks.yaml
  - ./gatus/ks.yaml
  - ./smartctl-exporter/ks.yaml
  - ./kromgo/ks.yaml

  # from network-services
  - ./cloudflare-dns/ks.yaml
  - ./cloudflare-tunnel/ks.yaml
  - ./echo/ks.yaml

  # Observability namespace + storage
  - ./observability-namespace/
