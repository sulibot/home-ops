- hosts: controlplane[0]
  become: yes
  tasks:
    - name: Check nodes
      shell: kubectl get nodes -o wide
      register: nodes
      changed_when: false
    - debug: var=nodes.stdout

    - name: Check Cilium status
      shell: kubectl -n kube-system get pods -l k8s-app=cilium
      register: cilium
      changed_when: false
    - debug: var=cilium.stdout

    - name: Check Flux status
      shell: flux get kustomizations --all
      register: flux
      changed_when: false
    - debug: var=flux.stdout
